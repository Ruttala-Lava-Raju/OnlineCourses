<!-- With Rerendering -->
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Add Syllabus</title>
	<link rel="stylesheet" type="text/css" href="Syllabus.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<script type="text/javascript">
    	var syllabus = [];
    	var emptySyllabusForm = {syllabusTitle: "", description: "", objective: "", editMode: true};

		function addSyllabus()
		{
			syllabus.push(emptySyllabusForm);
			renderCards();
			$("#addSyllabusBtn").prop('disabled', true);
		}

		function createForm(index, sectionSyllabus)
		{
			let syllabusForm =  `<div class="sectionSyllabus" id="form">
									<label id="syllabusNumber" class="p-3 bg-primary text-white">Syllabus ${index + 1}</label><br>
									<input type="text" name="syllabusTitle" id="syllabusTitle${index}" class="syllabusTitle" placeholder="syllabusTitle" value="${sectionSyllabus["syllabusTitle"]}"><br><br>
									<input type="text" name="description" id="description${index}" class="description" placeholder="Syllabus Description" value="${sectionSyllabus["description"]}"><br><br>
									<input type="text" name="objective" id="objective${index}" class="objective" placeholder="Learning Objectives" value="${sectionSyllabus["objective"]}"><br><br>
									<button id="save" class="btn btn-primary" title="Save" onclick="save(${index})"> Save</button>
									<button id="cancel" class="btn btn-primary" title="Cancel" onclick="cancel(${index})">Cancel</button>
									<br><br>
								</div>`;
			return(syllabusForm);
		}

		function cancel(index)
		{
			let sectionSyllabusData = syllabus[index];
			if((sectionSyllabusData.syllabusTitle == null) && (sectionSyllabusData.description == null) && (sectionSyllabusData.objective == null))
			{
				syllabus.splice(index, 1);
			}
			else
			{
				syllabus[index]["editMode"] = false;
			}
			renderCards();
			$("#addSyllabusBtn").prop('disabled', false);
		}

	    function save(index)
	    {
	    	let sectionSyllabusData = {syllabusTitle: $("#syllabusTitle" + index + "").val(), description: $("#description" + index + "").val(), objective: $("#objective" + index + "").val(), editMode: false};
	    	syllabus[index] = sectionSyllabusData;
	    	renderCards();
			$("#addSyllabusBtn").prop('disabled', false);
	    	console.log(syllabus);

	    }

	    function createCard(index, sectionSyllabus)
	    {
	    	let syllabusCard = `<div class="card">
		    					<div class="index rounded-circle">${index + 1}</div>
		    					<div class="minimizedcard">
		    						<label><b>${sectionSyllabus["syllabusTitle"]}</b></label><br>
		    						<label>${ sectionSyllabus["description"]}</label>
		    						<a href="#" id="delete" onclick="deleteSyllabusCard(${index})">Delete</a>
		    						<a href="#" id="edit" onclick="editSyllabusCard(${index})">Edit</a>
		    					</div>
		    				</div>`;
		    return(syllabusCard);
	    }

	    function renderCards()
	    {
	    	let index = 0;
	    	$("#syllabus").html("");
	    	for(var sectionSyllabus of syllabus)
	    	{
	    		if(sectionSyllabus["editMode"] == false)
	    		{
	    			var syllabusContent = createCard(index, sectionSyllabus);
	    		}
	    		else
	    		{
	    			var syllabusContent = createForm(index, sectionSyllabus);
	    		}
	    		$("#syllabus").append(syllabusContent);
	    		index++;
	    	}
	    }

	    function deleteSyllabusCard(index)
	    {
	    	let ok = confirm("Are You Sure?");
	    	if(ok)
	    	{
	    		syllabus.splice(index, 1);
	    		renderCards();
	    	}
	    	console.log(syllabus);
	    }

	    function editSyllabusCard(index)
	    {
	    	syllabus[index]["editMode"] = true;
	    	console.log(syllabus[index]["editMode"]);
	    	renderCards();
	    }

	</script>
</head>
<body id="body">
	<input type="button" name="addSyllabusBtn" id="addSyllabusBtn" title="Add Syllabus" value="Add Syllabus" onclick="addSyllabus()" class="btn btn-primary"><br>
	<div id="syllabus"></div>
</body>
</html>
