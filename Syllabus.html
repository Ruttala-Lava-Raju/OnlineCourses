<!DOCTYPE html>
<html>
<head>
	<title>Add Syllabus</title>
	<link rel="stylesheet" type="text/css" href="Syllabus.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<script type="text/javascript">
    	var syllabus = [];
    	var emptySyllabusForm = {syllabusTitle: "", description: "", objective: "", editMode: true, isTitleValid: true, isDescriptionValid: true, isObjectiveValid: true};

		function addSyllabus()
		{
			syllabus.push(emptySyllabusForm);
			renderCards();
			$("#addSyllabusBtn").prop('disabled', true);
		}

		function createForm(index, sectionSyllabus)
		{
			let syllabusForm =  `<div class="sectionSyllabus">
									<label class="p-3 bg-primary text-white">Syllabus ${index + 1}</label><br>
									<input type="text" name="syllabusTitle" id="syllabusTitle${index}" class="syllabusTitle" placeholder="syllabusTitle" value="${sectionSyllabus.syllabusTitle}"><br>`;
			if(sectionSyllabus.isTitleValid == false)
			{
				syllabusForm = syllabusForm + `<p class="errorMsg">Please enter syllabus title.</p>`;
			}
			else
			{
				syllabusForm = syllabusForm + "<br>";
			}

			syllabusForm = syllabusForm + `<input type="text" name="description" id="description${index}" class="description" placeholder="Syllabus Description" value="${sectionSyllabus.description}"><br>`;

			if (sectionSyllabus.isDescriptionValid == false) 
			{
				syllabusForm = syllabusForm + `<p class="errorMsg">Please enter syllabus description.</p>`;
			} 
			else 
			{
				syllabusForm = syllabusForm + "<br>";
			}

			syllabusForm = syllabusForm + `<input type="text" name="objective" id="objective${index}" class="objective" placeholder="Learning Objectives" value="${sectionSyllabus.objective}"><br>`;

			if (sectionSyllabus.isObjectiveValid == false) 
			{
				syllabusForm = syllabusForm + `<p class="errorMsg">Please enter syllabus objective.</p>`;
			} 
			else 
			{
				syllabusForm = syllabusForm + "<br>";
			}
			syllabusForm = syllabusForm + `<button id="save" class="btn btn-primary" title="Save" onclick="save(${index})"> Save</button>
			<button id="cancel" class="btn btn-primary" title="Cancel" onclick="cancel(${index})">Cancel</button>
			<br><br>
			</div>`;
			return(syllabusForm);
		}

		function cancel(index)
		{
			let sectionSyllabusData = syllabus[index];
			if((sectionSyllabusData.syllabusTitle == "") && (sectionSyllabusData.description == "") && (sectionSyllabusData.objective == ""))
			{
				syllabus.splice(index, 1);
			}
			else
			{
				sectionSyllabusData.editMode = false;
			}
			renderCards();
			$("#addSyllabusBtn").prop('disabled', false);
		}

		function save(index)
		{
			const title = $("#syllabusTitle" + index + "").val();
			const description = $("#description" + index + "").val();
			const objective = $("#objective" + index + "").val();
	    	syllabus[index]["isTitleValid"] = true;
	    	syllabus[index]["isDescriptionValid"] = true;
	    	syllabus[index]["isObjectiveValid"] = true;
	    	if (title == "" || description == "" || objective == "") 
	    	{
	    		syllabus[index]["editMode"] = true;
	    		if (title == "") 
    			{
    				syllabus[index]["isTitleValid"] = false;
    			}

    			if (description == "") 
    			{
    				syllabus[index]["isDescriptionValid"] = false;
    			}

    			if(objective == "")
    			{
    				syllabus[index]["isObjectiveValid"] = false;
    			}
		    }
		    else
		    {
		    	let sectionSyllabusData = {syllabusTitle: title, description: description, objective: objective, editMode: false, isTitleValid: true, isDescriptionValid: true, isObjectiveValid: true};
		    	syllabus[index] = sectionSyllabusData;
		    }
	    	renderCards();
			$("#addSyllabusBtn").prop('disabled', false);
		}

	    function createCard(index, sectionSyllabus)
	    {
	    	let syllabusCard = `<div class="card">
		    					<div class="index rounded-circle">${index + 1}</div>
			    					<div class="minimizedcard">
			    						<label><b>${sectionSyllabus["syllabusTitle"]}</b></label><br>
			    						<label>${ sectionSyllabus["description"]}</label>
			    						<a href="#" id="delete" onclick="deleteSyllabusCard(${index})">Delete</a>
			    						<a href="#" id="edit" onclick="editSyllabusCard(${index})">Edit</a>
			    					</div>
			    				</div>`;
		    return(syllabusCard);
	    }

	    function renderCards()
	    {
	    	let index = 0;
	    	$("#syllabus").html("");
	    	for(const sectionSyllabus of syllabus)
	    	{
	    		if(sectionSyllabus["editMode"] == false)
	    		{
	    			var syllabusContent = createCard(index, sectionSyllabus);
	    		}
	    		else
	    		{
	    			var syllabusContent = createForm(index, sectionSyllabus);
	    		}
	    		$("#syllabus").append(syllabusContent);
	    		index++;
	    	}
	    }

	    function deleteSyllabusCard(index)
	    {
	    	let ok = confirm("Are You Sure?");
	    	if(ok)
	    	{
	    		syllabus.splice(index, 1);
	    		renderCards();
	    	}
	    }

	    function editSyllabusCard(index)
	    {
	    	syllabus[index]["editMode"] = true;
	    	renderCards();
	    }

	</script>
</head>
<body id="body">
	<input type="button" name="addSyllabusBtn" id="addSyllabusBtn" title="Add Syllabus" value="Add Syllabus" onclick="addSyllabus()" class="btn btn-primary"><br>
	<div id="syllabus"></div>
</body>
</html>
